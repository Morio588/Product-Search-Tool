<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>iStore 登入系統</title>
  <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js"></script>
</head>
<body>
  <h2>登入 iStore 系統</h2>
  <button id="loginBtn">使用 Google 登入</button>

  <script>
    // ======= 你的 Firebase 設定 =======
    const firebaseConfig = {
      apiKey: "AIzaSyAQH0RqBBwRQthE7vj80cH994GFkEYU1ho",
    authDomain: "istore-login-tc.firebaseapp.com",
    projectId: "istore-login-tc",
    storageBucket: "istore-login-tc.firebasestorage.app",
    messagingSenderId: "709619679365",
    appId: "1:709619679365:web:62a50024c61b54954129ec",
    measurementId: "G-K6JHQ9RD4Y"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // ======= 登入邏輯 =======
    document.getElementById("loginBtn").addEventListener("click", () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then(result => {
          const email = result.user.email;
          // ✅ 限制只能 istore.com.tw 網域登入
          if (email.endsWith("@istore.com.tw")) {
            localStorage.setItem("userEmail", email);
            window.location.href = "main.html"; // 登入成功後跳轉
          } else {
            alert("禁止外部帳號登入！");
            auth.signOut();
          }
        })
        .catch(error => {
          console.error(error);
          alert("登入失敗：" + error.message);
        });
    });
  </script>
</body>
</html>
